<html>
<head>
  <title>Evernote Export</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/605061 (zh-CN, DDL); Windows/10.0.0 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="561"/>

<div>
<span><div><div>系统： VMware虚拟机+Linux 20.04</div><div><br/></div><div>新建px4开发文件夹，后续的环境配置在该文件夹下进行</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>mkdir px4</div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">cd px4/</span></div></div><div><span style="font-size: 14pt; color: rgb(173, 0, 0); font-weight: bold;">PX4配置环境</span></div><div><span style="font-size: 16px; color: rgb(77, 77, 77); font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; font-variant-ligatures: no-common-ligatures; font-weight: bold;">1.添加</span><span style="font-size: 16px; color: rgb(77, 77, 77); font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; font-variant-ligatures: no-common-ligatures; font-weight: bold;">用户到dialout工作组</span></div><div><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(77, 77, 77); font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; font-variant-caps: normal; font-variant-ligatures: no-common-ligatures;">将你创建的用户加入到用户组dialout中去，注销后重新登录。创建独立用户的目的是这样可以让开发环境分离开来，避免出现不同用户间的版本冲突等情况。将用户加入dialout用户组的目的是dialout拥有对串口tty的操作权限。</span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>sudo usermod-a -G dialout$USER</div></div><div><span style="font-size: 12pt; color: rgb(77, 77, 77);">完成用户组添加后重启Linux系统使其生效</span></div><div><span style="font-size: 16px;"><br/></span></div><div><span style="font-size: 12pt; color: rgb(77, 77, 77); font-weight: bold;">2.</span> <span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(77, 77, 77); font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif, SimHei, SimSun; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">更新软件源列表</span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>sudo apt-get update -y</div></div><div><span style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(77, 77, 77); font-weight: bold;">3.安装软件依赖包</span></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="color: rgb(77, 77, 77);"><font style="font-size: 12pt;">sudo apt-get install git zip qtcreator cmake build-essential genromfs ninja-build exiftool -y</font></span></div></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">4.安装常用Python依赖包及管理工具</span></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>sudo apt-get install python-argparse</div><div>sudo apt-get install python3-empy python3-toml python3-numpy python3-yaml \</div><div>        python3-dev python3-pip -y</div><div>sudo -H pip install --upgrade pip</div><div>  </div><div>sudo -H pip install pandas jinja2 pyserial cerberus  -i https://pypi.douban.com/simple</div></div><div><span style="font-size: 16px;"><span style="font-size: 16px; font-weight: bold;">当存在多个python环境时，采用pip 或 sudo pip安装时，会存pip帮点的python环境与想要安装python依赖包的环境不一致的问题，可参考一下方法去更改Linux pip指令连接的python环境。</span></span></div><div><span style="font-size: 16px;"><span style="font-size: 16px; font-weight: bold;">参考链接：</span></span><span style="font-size: 12pt;"><a href="https://www.jianshu.com/p/4fb24d6b4946" style="font-size: 12pt; font-weight: bold;">https://www.jianshu.com/p/4fb24d6b4946</a></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-size: 16px;"># pip的修改方式</span></div><div><span style="font-size: 16px;">sudo gedit ~/.bashrc</span></div><div><span style="font-size: 16px;">#在最后一行添加如下命令：</span></div><div><span style="font-size: 16px;">alias pip=<font style="color: rgb(173, 0, 0);">python路径</font>/bin/pip</span></div><div><span style="font-size: 16px;">alias pip3=<font color="#AD0000">python路径</font>/bin/pip</span></div><div><span style="font-size: 16px;">#保存退出后，使用如下更新命令</span></div><div><span style="font-size: 16px;">source ~/.bashrc</span></div></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div># sudo pip的修改方式</div><div>sudo gedit /etc/profile</div><div>#在最后一行添加如下命令：</div><div>alias pip=<font color="#AD0000">python路径</font>/bin/pip</div><div>alias pip3=<font color="#7B003D">python路径</font>/bin/pip</div><div>#保存退出后，使用如下更新命令</div><div>source /etc/profile</div></div><div><font style="font-size: 14pt;"><br/></font></div><div><span style="font-size: 14pt; color: rgb(173, 0, 0); font-weight: bold;">解决git clone网速问题，配置科学上网工具</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 16px;"><span style="font-size: 16px; color: rgb(123, 0, 61); font-weight: bold;">虚拟机Linux科学上网不建议配置clash代理，当前网络提供的clash代理的设置比较繁琐，切管理比较复杂，需要一定的Linux功底。在本人尝试的clash配置中，通过多次尝试，最终还是未能成功实现自由访问git</span><span style="font-size: 16px; color: rgb(123, 0, 61);">。</span></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 16px;">安装科学上网工具，对于后续的git clone等帮助较大。</span></div><div><span style="font-size: 16px;">科学上网工具，网络存在免费和收费多种，可以自行考虑。付费的网络速度与稳定性优于免费。</span></div><div><span style="font-size: 16px;">1.在windows下安装vpn代理，开启局域网代理。检查是否可以登陆google、YouTube和git等网络。</span></div><div><span style="font-size: 16px;">2.关闭Windows的防火墙。以防对于虚拟机的桥接模式影响。</span></div><div><span style="font-size: 16px;">3.在虚拟机VM中设置虚拟机网络模式为桥接模式。</span></div><div><span style="font-size: 16px;">4.在虚拟机中设置代理，代理IP为主机IP，端口号为代理端口号。</span></div><div><img src="px4二次开发环境构建_files/捕获3.JPG" type="image/jpeg" data-filename="捕获3.JPG"/></div><hr/><div><span style="font-size: 16px; color: unset; font-family: unset;">1.安装网络代理可能导致网络网络无法连接事，在Internet属性（命令行打开方式为：运行- inetcpl.cpl ）的连接栏设置局域网（局域网设置），取消代理服务器。</span></div><div><img src="px4二次开发环境构建_files/捕获.JPG" type="image/jpeg" data-filename="捕获.JPG"/></div></div><div><br/></div><div><span style="font-size: 14pt; color: rgb(173, 0, 0); font-weight: bold;">PX4开发环境工具链安装</span></div><div><font style="font-size: 14pt;"><br/></font></div><div>参考官网： <a href="https://docs.px4.io/master/en/dev_setup/dev_env_linux_ubuntu.html">Ubuntu Development Environment | PX4 User Guide</a></div><div>1.git克隆PX4项目到本地开发目录</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>git clone https://github.com/PX4/PX4-Autopilot.git --recursive</div></div><div><img src="px4二次开发环境构建_files/git-px4.JPG" type="image/jpeg" data-filename="git-px4.JPG"/></div><div>2.检查子模块克隆是否完整</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div># 进入克隆的px4目录下</div><div>cd PX4-Autopilot/</div><div># 更新下载子模块</div><div>it submodule update --init --recursive</div></div><div><img src="px4二次开发环境构建_files/git-px41.JPG" type="image/jpeg" data-filename="git-px41.JPG"/></div><div>3.通过ubuntu.sh 文件安装工具链</div><div>这一步中需要安装python依赖包，需要对项目的ubuntu.sh中安装python的部分进行修改，更改python 的pip 源。    </div><div>1.在./PX4-Autopilot/Tools/setup中找到ubuntu.sh文件，打开编辑：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;"># 更改pip源</span></div><div><span style="font-size: 9pt; font-family: Monaco;"><font color="#AD0000">#改前</font></span></div><div># Python3 dependencies</div><div>echo</div><div>echo &quot;Installing PX4 Python3 dependencies&quot;</div><div>if [ -n &quot;$VIRTUAL_ENV&quot; ]; then</div><div>    # virtual envrionments don't allow --user option</div><div><font color="#AD0000">    python -m pip install -i -r ${DIR}/requirements.txt</font></div><div>else</div><div>    # older versions of Ubuntu require --user option</div><div>   <font color="#AD0000"> python3 -m pip install -i --user -r ${DIR}/requirements.txt</font></div><div><br/></div><div><br/></div><div><font color="#AD0000">#改后 </font></div><div># Python3 dependencies</div><div>echo</div><div>echo &quot;Installing PX4 Python3 dependencies&quot;</div><div>if [ -n &quot;$VIRTUAL_ENV&quot; ]; then</div><div>    # virtual envrionments don't allow --user option</div><div>    <font style="color: rgb(173, 0, 0);">python -m pip install -i https://pypi.tuna.tsinghua.edu.cn/simple -r ${DIR}/requirements.txt</font></div><div>else</div><div>    # older versions of Ubuntu require --user option</div><div><font color="#AD0000">    python3 -m pip install -i https://pypi.tuna.tsinghua.edu.cn/simple --user -r ${DIR}/requirements.txt</font></div></div><div>2.运行安装脚本，完成工具链安装。</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>bash ./PX4-Autopilot/Tools/setup/ubuntu.sh</div><div># 时间比较久</div><div># 运行完成后，通过查看gcc版本检查Nuttx是否安装成功</div><div>arm-none-eabi-gcc --version</div></div><div>3.编译px4仿真（gazebo和jmavsim）</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div># 先cd到px4项目目录下</div><div># jmavsim仿真</div><div>make px4_sitl jmavsim</div></div><div><img src="px4二次开发环境构建_files/jimsim.JPG" type="image/jpeg" data-filename="jimsim.JPG"/></div><div>提示无接收机和数据链，为非安全模式，可先通过一下代码测试起飞降落的仿真功能是否可以执行。</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>pxh&gt; param set NAV_RCL_ACT 0</div><div>  NAV_RCL_ACT: curr: 2 -&gt; new: 0</div><div>pxh&gt;</div><div>pxh&gt; param set NAV_DLL_ACT 0</div></div><div>然后运行起飞和降落指令</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>pxh&gt; commander takeoff</div><div># 四轴可以正常起飞</div><div>pxh&gt; commander land</div><div>#四轴可以正常降落</div><div># 通过help指令获取常用指令，对于改变风力测试四轴自稳进行测试。</div></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div># 先cd到px4项目目录下</div><div># gazebo仿真</div><div>make px4_sitl_default gazebo</div></div><div><img src="px4二次开发环境构建_files/gazebo.JPG" type="image/jpeg" data-filename="gazebo.JPG"/></div><div><br/></div><div>px4 仿真流程介绍： <a href="https://blog.csdn.net/qq_19469271/article/details/119963938">(6条消息) ROS+Gazebo+PX4仿真步骤_chen果冻的博客-CSDN博客_gazebo无人机仿真</a></div><div><br/></div><div><span style="color: rgb(173, 0, 0); font-weight: bold;">ROS安装</span></div><div>1.添加ros软件源</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>sudo apt-key adv --keyserver 'hkp://keyserver.ubuntu.com:80' --recv-key C1CF6E31E6BADE8868B172B4F42ED6FBAB17C654</div></div><div>2.添加秘钥</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>sudo apt-key adv --keyserver 'hkp://keyserver.ubuntu.com:80' --recv-key C1CF6E31E6BADE8868B172B4F42ED6FBAB17C654</div></div><div>3.安装ros（与系统版本保持一直，20.04对应noetic版本）</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>sudo apt install ros-noetic-desktop-full</div><div>sudo apt update</div></div><div>4.检查ros是否安装成功</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div># </div><div>sudo rosdep init</div><div><font color="#AD0000"><br/></font></div><div><font color="#AD0000"># 如果显示命令找不到</font></div><div>sudo apt install python3-rosdep2 -y</div><div>#或者</div><div>sudo apt install python-rosdep -y</div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;"><br/></span></div><div><font color="#AD0000"><span style="font-size: 9pt; font-family: Monaco;">#</span>ERROR: cannot download default sources list from:</font></div><div><font color="#AD0000">#https://raw.githubusercontent.com/ros/rosdistro/master/rosdep/sources.list.d/20-default.list</font></div><div><font color="#AD0000">#Website may be down.</font></div><div><br/></div><div>sudo gedit /etc/hosts</div><div>#在文件末尾添加</div><div>151.101.84.133  raw.githubusercontent.com</div><div>#或者 151.101.76.133  raw.githubusercontent.com</div></div><div>5.检查rosdep update</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>rosdep update</div></div><div>6.<span style="font-size: 12pt; color: rgb(79, 79, 79); font-family: &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun;">设置环境变量</span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="color: rgb(79, 79, 79); font-family: &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun;">echo &quot;source /opt/ros/noetic/setup.bash&quot; &gt;&gt; ~/.bashrc</span></div><div><span style="color: rgb(79, 79, 79); font-family: &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun;">source ~/.bashrc</span></div></div><div>7.<span style="font-size: 12pt; color: rgb(79, 79, 79); font-family: &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun;">安装rosinstall</span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>sudo apt install python3-rosinstall python3-rosinstall-generator python3-wstool build-essential</div></div><div>8.验证ros是否安装成功</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>roscore</div></div><div>如果报错如下</div><div><img src="px4二次开发环境构建_files/捕获 [1].JPG" type="image/jpeg" data-filename="捕获.JPG"/></div><div>运行命令</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>sudo apt install ros-noetic-desktop-full</div></div><div>再次运行</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>roscore</div></div><div><img src="px4二次开发环境构建_files/捕获1.JPG" type="image/jpeg" data-filename="捕获1.JPG"/></div><div>安装成功</div><div>9.运行启动小乌龟</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>rosrun turtlesim turtlesim_node</div></div><div>10.安装gazebo的ros插件</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>sudo apt install ros-noetic-gazebo-*  # 注意ros版本对应，20.04 noetic</div></div><div>安装完成后，运行一下代码检查是否安装完成，</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>#终端1启动ros</div><div>roscore</div><div>#终端2启动gazebo</div><div>rosrun gazebo_ros gazebo</div></div><div><img src="px4二次开发环境构建_files/捕获 [2].JPG" type="image/jpeg" data-filename="捕获.JPG"/></div><div>如图所说，则安装成功。</div><div>11.安装mavros</div><div>1）mavros安装</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>#1</div><div>sudo apt install ros-noetic-mavros ros-noetic-mavros-extras</div><div>#2</div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">roscd mavros</span></div><div>wget https://raw.githubusercontent.com/mavlink/mavros/master/mavros/scripts/install_geographiclib_datasets.sh</div><div>#3</div><div>sudo ./install_geographiclib_datasets.sh</div><div># 该步花费时间较长</div></div><div><img src="px4二次开发环境构建_files/4.JPG" type="image/jpeg" data-filename="4.JPG"/></div><div>如上图所示，则安装结束。</div><div>2）编译工具安装</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>#安装编译工具</div><div>sudo apt-get install python3-catkin-tools python3-rosinstall-generator -y</div></div><div>3）创建mavros工作空间，建议新建单独的工作空间，后续的编译只能用catkin build进行，而不能用catkin_make。</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>mkdir -p ~/mavros_ws/src</div><div><br/></div><div>cd ~/mavros_ws</div><div><br/></div><div>catkin init</div><div><br/></div><div># If this is your first time using wstool you will need to initialize your source space with</div><div>wstool init src</div><div><br/></div><div># 安装MAVLink</div><div>rosinstall_generator --rosdistro kinetic mavlink | tee /tmp/mavros.rosinstall</div><div># 安装MAVROS</div><div>rosinstall_generator --upstream-development mavros | tee -a /tmp/mavros.rosinstall</div><div><br/></div><div># 创建工作区和依赖环境</div><div>wstool merge -t src /tmp/mavros.rosinstall</div><div>wstool update -t src -j4  # j后面的数与自身系统放的线程数匹配</div><div>rosdep install --from-paths src --ignore-src -y</div><div><br/></div><div># 安装 [GeographicLib](https://geographiclib.sourceforge.io/) 数据集</div><div><br/></div><div># 编译源码</div><div>catkin build</div></div><div>编译结束，效果如下</div><div><img src="px4二次开发环境构建_files/捕获 [3].JPG" type="image/jpeg" data-filename="捕获.JPG"/></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(173, 0, 0); font-weight: bold;">安装Ninjia编译工具</span></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>sudo apt-get install ninja-build -y</div></div><div><font style="font-size: 12pt;"><span style="font-size: 12pt; color: rgb(123, 0, 61); font-weight: bold;">安装地面站QGC</span></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>sudo apt install gstreamer1.0-plugins-bad gstreamer1.0-libav gstreamer1.0-gl -y</div><div>sudo apt install libqt5gui5 -y</div></div><div>下载QGroundControl.AppImage：<a href="https://d176tv9ibo4jno.cloudfront.net/latest/QGroundControl.AppImage">https://d176tv9ibo4jno.cloudfront.net/latest/QGroundControl.AppImage</a></div><div>将QGroundControl.AppImage放置到安装目录下，更改文件权限，并运行</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;"># cd 到存储目录下</span></div><div>chmod +x ./QGroundControl.AppImage</div><div>./QGroundControl.AppImage  (or double click)</div></div><div>启动地面站，如图所示：</div><div><img src="px4二次开发环境构建_files/捕获1 [1].JPG" type="image/jpeg" data-filename="捕获1.JPG"/></div><div>启动jMAvsim，结合QGC，尝试连接地面站与PX4仿真。</div><div><img src="px4二次开发环境构建_files/111.JPG" type="image/jpeg" data-filename="111.JPG"/></div><div>多机仿真gazebo</div><div><a href="https://www.guyuehome.com/34953">【PX4｜mavros】Gazebo 多机仿真｜C++ 类封｜装位置控制 - 古月居 (guyuehome.com)</a></div><div>编译工具安装VScode</div><div><br/></div><div>1.前往官网 <a href="https://code.visualstudio.com/docs/setup/linux">Running Visual Studio Code on Linux</a>下载对应版本安装包deb文件</div><div>2.参考官网安装指导完成VScode安装。</div><div>3.开启VScode，并导入PX4项目。</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>czx@czx-virtual-machine:~/Desktop$ code</div><div><br/></div><div>#Select Open folder ... option on the welcome page (or using the menu: File &gt; Open Folder):</div><div># 选择git的px4项目</div><div><br/></div><div>#选择信任该文件夹</div><div>#安装所需插件</div></div><div><img src="px4二次开发环境构建_files/prompt_install_extensions.03b97ce1.jpg" type="image/jpeg" data-filename="prompt_install_extensions.03b97ce1.jpg"/></div><div><br/></div></span>
</div></body></html> 